%% BIG 2015 Kaggle project

clc;
close all;
clear all;

datapath = 'D:\BIG_2015\train\train\';
files = dir([datapath,'*.bytes']);
filename = {files.name};
load all_image_data.mat

delimiter ={'\t',',',' ',';'};
start = 1;
end_idx = inf;

formatspec = '%8s%3s%3s%3s%3s%3s%3s%3s%3s%3s%3s%3s%3s%3s%3s%3s%s%[^\n\r]';

for i = 7567

i

fileID = fopen([datapath,filename{i}]);
text_data = textscan(fileID, formatspec, end_idx-start+1,'HeaderLines', 1, 'Delimiter', delimiter, 'EmptyValue',...
                            NaN, 'ReturnOnError',0);

for j = 2:17
text_data_V2{j-1} = strtrim(text_data{j});
size_array(j-1) = length(text_data_V2{j-1});
end

min_size =min(size_array);

for k = 1: 16
text_data_V2{k} = text_data_V2{k}(1:min_size);
end

fclose(fileID);

decimal = zeros(min_size ,16);
for n = 1:16
idx = find(strcmp(text_data_V2{n},'??'));
decimal(idx,n) = -1;

temp = setdiff(1:min_size,idx);
decimal(temp,n)= hex2dec(text_data_V2{n}(temp));
end

images=imresize(decimal,[256 16]);
all_images(i,:)=images(:);
end

%save all_image_data all_images filename;